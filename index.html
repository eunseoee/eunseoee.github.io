<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=location_on" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=device_thermostat" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=humidity_low" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment-with-locales.min.js"></script>
</head>
<style>
    *{
      margin: 0;
      padding: 0;
      font-family: "Noto Sans", sans-serif;
      color: #202020;
      box-sizing: border-box;
    }

    html{
        width: 393px;
        background-color: #5AD3FF;
        margin-left: auto;
        margin-right: auto;
    }
    .nav{
        padding-left: 40px;
        margin-bottom: 60px;
        margin-top: 60px;
        position: relative;
    }
    .material-symbols-outlined.loc{
        height: 20px;
        font-size: 8px;
    }
    #city{
        font-size: 18px;
        font-weight: 500;
        display: inline-block;
    }
    .lo{
        display: flex;
        align-items: center;
        margin-bottom: 46px;
        margin-left: -4px;
    }
    .nav_tem{
        font-size: 60px;
        font-weight: 700;
        margin-bottom: 16px;
    }
    #nav_temmm{
        display: inline-block;
        font-size: 18px;
    }
    .now_weather{
        width: 180px;
        height: 180px;
        position: absolute;
        top: 28px;
        right: 36px;
    }
    .te{
        display: flex;
        align-items: center;
        margin-bottom: 16px;
        margin-left: -7px;
    }
    /* 여기까지 nav 영역 */
    .day{
        margin-left: 18px;
        margin-right: 18px;
        background-color: #BFEEFF;
        padding: 40px 30px;
        border-radius: 20px;
        margin-bottom: 22px;
    }
    .day_one{
        text-align: center;
        display: inline-block;
        margin-right: 20px;
    }
    .day_one:last-child {
        text-align: center;
        display: inline-block;
        margin-right: 0px;
    }
    .day_ti{
        margin-bottom: 8px;
        font-size: 12px;
        color: #202020;
    }
    .day_tem{
        margin-bottom: 8px;
        font-weight: 700;
    }
    .day_we{
        width: 24px;
        height: 24px;
    }
    .hu{
        height: 10px;
        display: inline-block;
    }
    .day_w{
        display: flex;
        align-items: center;
    }
    .day_wat{
        font-size: 12px;
        text-align: center;
        display: inline-block;
    }
    .forecast{
        display: flex;
    }
    /* 여기까지 day 영역 */
    .ddate{
        margin-left: 18px;
        margin-right: 18px;
        background-color: #BFEEFF;
        border-radius: 20px;
        margin-bottom: 22px;
        padding: 30px 30px;
    }
    #date{
        display: flex;
        justify-content: center; 
        align-items: center;     
        flex-wrap: wrap;        
    }
    .date_one{
        margin-top: 16px;
        height: 24px;
        display: flex;
        justify-content: center;
        
    }
    .date_d{
        display: inline-block;
        margin-right: 28px;
        width: 36px;
    }
    .date_temmm{
        display: inline-block;
        margin-right: 28px;
        width: 60px;
        font-weight: 700;
    }
    .date_we{
        width: 24px;
        height: 24px;
        margin-right: 28px;
    }
    .date_one .hu{
        height: 20px;
        margin-top: 2px;
        
    }
    .date_rain{
        display: inline-block;
        width: 50px;
        text-align: left;
    }
    /* 여기까지 date 영역 */

    body.is-night .date_d, body.is-night .date_temmm, body.is-night .date_rain{
        color: #ffffff;
    }

    body.is-night .ddate{
        background-color: #5B899A;
    }

    body.is-day .date_d, body.is-day .date_temmm, body.is-day .date_rain{
        color: #202020;
    }

    body.is-day .ddate{
        background-color: #BFEEFF;
    }
    body.is-night .day_ti, body.is-night .day_tem, body.is-night .day_wat{
        color: #ffffff;
    }

    body.is-night .day{
        background-color: #5B899A;
    }

    body.is-day .day_ti, body.is-day .day_tem, body.is-day .day_wat{
        color: #202020;
    }

    body.is-day .day{
        background-color: #BFEEFF;
    }
    /* 여기까지 밤낮별 css 변화 */

    .popup{
        background-color: #EBFAFF;
        height: 50px;
        position: fixed;
        bottom: 0;
        left: 50%;
        width: 393px;
        transform: translateX(-50%);
        z-index: 1000;
        border-radius: 20px 20px 0px 0px;
    }
    .pop_line{
        width: 40px;
        height: 1px;
        background-color: #5AD3FF;
        position: absolute;
        top: 50%;
        margin-left: calc((393px - 40px) / 2);
    }
    .hi_pop{
        width: 393px;
        height: 400px;
        background-color: #EBFAFF;
        display: none;
        position: fixed;
        bottom: 0;
    }
    /* popup 큰 틀 */
    .pop_text {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        gap: 30px;
        margin-top: 16px;
    }
    .hu_group{
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .wind_group{
        display: flex;
        flex-direction: column; 
        align-items: center;
    }
    .hu_text{
        font-size: 12px;
    }
    .hu_per{
        font-size: 20px;
        align-items: center;
    }
    .wind_text{
        font-size: 12px;
    }
    .wind_per{
        font-size: 20px;
        align-items: center;
    }
    @keyframes planeFloat {
        0% {transform: translateY(0) rotate(0deg); }
        30% {transform: translateY(-20px) rotate(10deg);}
        70% {transform: translateY(20px) rotate(-10deg);}
        100% {transform: translateY(0) rotate(0deg); }
    }
    .plane_img{
        width: 100px;
        position: fixed;
        bottom: 160px;
        transition: all 0.6s ease-in-out;
        animation: planeFloat 3s ease-in-out infinite;
    }

</style>

<body>
    <div class="nav">
        <div class="lo">
            <img class="material-symbols-outlined loc" src="location_on.png" alt="#">
            <h1 id="city"></h1>
        </div>
        <h2 class="nav_tem"></h2>
        <div class="te">
            <img class="material-symbols-outlined tem" src="device_thermostat.png" alt="#">
            <h3 id="nav_temmm"></h3>
        </div>
        <h4 id="weather"></h4>
        <img class="now_weather"></img>
    </div>
    <!-- 여기까지가 맨 위 현재 정보들 -->
    <div class="day">
        <div class="forecast"></div>
    </div>
    <!-- 여기까지가 하루 정보 -->
    <div class="ddate">
        <div id="date"></div>
        <div class="weather_box"></div>
    </div>
    <!-- 여기까지가 날짜별 정보 -->
    <div class="popup">
        <div class="pop_line"></div>
    </div>
    <div class="hi_pop"></div>



    <script>

        $(function(){
            let url = 'https://api.openweathermap.org/data/2.5/weather?lat=37.3236&lon=126.8219&&appid=b9c53bd36519cf96f998cd148be70961&units=metric'

            // 현재 날씨
            $.getJSON(url, function(data){
                console.log(data)
                
                    let city = data.name
                    let weather = data.weather[0].main
                    let to_temp = Math.floor(data.main.temp)
                    let to_temp_max = Math.floor(data.main.temp_max)
                    let to_temp_min = Math.floor(data.main.temp_min)
                    let icon = data.weather[0].icon

                    if (icon.includes('n')) {
                        $('body').addClass('is-night');
                    } else {
                        $('body').addClass('is-day');
                    }

                    let hu_hu = data.main.humidity
                    let wind = Math.floor(data.wind.speed)


                    $('#city').text(city)
                    $('.nav_tem').text(to_temp + '°')
                    $('#nav_temmm').text(to_temp_max + '°' + '/' + to_temp_min + '°')
                    $('#weather').text(weather)

                    //popup 내용들
                    let dom3 = $('<div class="pop_st"></div>');

                    let huGroup = $('<div class="hu_group"></div>');
                    huGroup.append('<p class="hu_text">습도</p>');
                    huGroup.append('<h5 class="hu_per">' + hu_hu + '%</h5>');

                    let windGroup = $('<div class="wind_group"></div>');
                    windGroup.append('<p class="wind_text">바람</p>');
                    windGroup.append('<h6 class="wind_per">' + wind + 'm/s</h6>');

                    let popText = $('<div class="pop_text"></div>');
                    popText.append(huGroup);
                    popText.append(windGroup);

                    let plane = $('<img class="plane_img" src="paper_plane.png" alt="#">')
                    

                    dom3.append(plane)
                    dom3.append(popText);

                    // 습도와 바람에 따른 종이비행기 변화
                    if (hu_hu <= 40) {
                        plane.attr('src', 'dry_plane.png');
                    } else if(hu_hu <= 70){
                        plane.attr('src', 'paper_plane.png')
                    } else {
                        plane.attr('src', 'wet_plane.png')
                    }

                    if(wind <= 4){
                        plane.css('left', '54vw')
                    } else if(wind <= 9){
                        plane.css('left', '46vw')
                    } else{
                        plane.css('left', '38vw')
                    }
                    $('.hi_pop').append(dom3);
                    
                    //날씨별 이미지 변화
                    if(icon == '01d'){
                        $('.now_weather').attr('src', 'sun_top.png')
                    } else if(icon == '01n'){
                        $('.now_weather').attr('src', 'night_top.png')
                    } else if(icon == '02d' || icon == '02n' || icon == '03d' || icon == '03n' || icon == '04d' || icon == '04n' ){
                        $('.now_weather').attr('src', 'cloud_top.png')
                    } else if(icon == '09d' || icon == '09n' || icon == '10d' || icon == '10n' ){
                        $('.now_weather').attr('src', 'rain_top.png')
                    } else if(icon == '11d' || icon == '11n'){
                        $('.now_weather').attr('src', 'storm_top.png')
                    } else if(icon == '13d' || icon == '13n'){
                        $('.now_weather').attr('src', 'snow_top.png')
                    } else if(icon == '50d' || icon == '50n'){
                        $('.now_weather').attr('src', 'mist_top.png')
                    }

                    // 밤낮별 색상 변화
                    if(icon.includes('d')){
                        document.documentElement.style.backgroundColor = '#5AD3FF'
                        $('h1').css('color', '#202020');
                        $('h2').css('color', '#202020');
                        $('h3').css('color', '#202020');
                        $('h4').css('color', '#202020');
                        $('p').css('color', '#202020');
                        $('.popup').css('background-color', '#EBFAFF')
                        $('.hi_pop').css('background-color', '#EBFAFF')
                        $('.pop_line').css('background-color', '#5AD3FF')
                        $('.hu_text').css('color', '#202020');
                        $('.wind_text').css('color', '#202020');
                        $('.hu_per').css('color', '#202020');
                        $('.wind_per').css('color', '#202020');
                        
                    } else if(icon.includes('n')){
                        document.documentElement.style.backgroundColor = '#165166'
                        $('h1').css('color', '#EBEBEB');
                        $('h2').css('color', '#EBEBEB');
                        $('h3').css('color', '#EBEBEB');
                        $('h4').css('color', '#EBEBEB');
                        $('p').css('color', '#EBEBEB');
                        $('.material-symbols-outlined.loc').attr('src', 'location_on_n.png')
                        $('.material-symbols-outlined.tem').attr('src', 'device_thermostat_n.png')
                        $('.popup').css('background-color', '#2D3E44')
                        $('.hi_pop').css('background-color', '#2D3E44')
                        $('.pop_line').css('background-color', '#EBEBEB')
                        $('.hu_text').css('color', '#EBEBEB');
                        $('.wind_text').css('color', '#EBEBEB');
                        $('.hu_per').css('color', '#EBEBEB');
                        $('.wind_per').css('color', '#EBEBEB');
                    }

                
            })
        })

        // 3시간 단위 날씨
        $(function(){
            let url = 'https://api.openweathermap.org/data/2.5/forecast?lat=37.3236&lon=126.8219&units=metric&appid=b9c53bd36519cf96f998cd148be70961'


            $.getJSON(url, function(data){
                console.log(data)


                for(let i=0; i<6; i++){
                    let city = data.city.name
                    let weather = data.list[i].weather[0].description
                    let temp = Math.floor(data.list[i].main.temp)
                    let temp_max = Math.floor(data.list[i].main.temp_max)
                    let temp_min = Math.floor(data.list[i].main.temp_min)
                    let dt = data.list[i].dt
                    let time = moment(dt * 1000).format('HH:mm')
                    let day = moment(dt*1000).format('MM/DD')
                    let rain = data.list[i].rain
                    let icon = data.list[i].weather[0].icon

                    if(rain == null){
                        rain = 0
                    }

                    // 시간별 데이터 작성
                    let dom = $('<div class="day_one"></div>')
                    dom.append('<p class="day_ti">' + time + '</p>')
                    dom.append('<img class="day_we" src="sun.png" alt="#">')
                    dom.append('<p class="day_tem">' + temp + '°' + '</p>')
                    dom.append('<img class="hu" src="humidity_mid.png" alt="#">' + '<p class="day_wat">' + rain + '%</p>')

                    if ($('body').hasClass('is-night')) {
                        dom.find('.hu').attr('src', 'humidity_mid_n.png');
                    } else {
                        dom.find('.hu').attr('src', 'humidity_mid.png');
                    }


                    if(icon == '01d'){
                        dom.find('.day_we').attr('src', 'sun.png')
                    } else if(icon == '01n'){
                        dom.find('.day_we').attr('src', 'night.png')
                    } else if(icon == '02d' || icon == '02n' || icon == '03d' || icon == '03n' || icon == '04d' || icon == '04n' ){
                        dom.find('.day_we').attr('src', 'cloud.png')
                    } else if(icon == '09d' || icon == '09n' || icon == '10d' || icon == '10n' ){
                        dom.find('.day_we').attr('src', 'rain.png')
                    } else if(icon == '11d' || icon == '11n'){
                        dom.find('.day_we').attr('src', 'storm.png')
                    } else if(icon == '13d' || icon == '13n'){
                        dom.find('.day_we').attr('src', 'snow.png')
                    } else if(icon == '50d' || icon == '50n'){
                        dom.find('.day_we').attr('src', 'mist.png')
                    }

                    $('.forecast').append(dom)

                }
            })
        })
        
        let Open = false;

        $('.popup').click(function(){
            if(!Open){
                $('.hi_pop').slideDown(400);
                $('.popup').animate({bottom: '400px'}, 400)
                Open = true;
            } else {
                $('.hi_pop').slideUp(400);
                $('.popup').animate({bottom: '0px'}, 400)
                Open = false;
            }
        })        


        // 30일간 날씨
        $(function(){
            let url = 'https://api.openweathermap.org/data/2.5/forecast/daily?lat=37.3236&lon=126.8219&cnt=7&appid=b9c53bd36519cf96f998cd148be70961&units=metric'

            $.getJSON(url, function(data){
                console.log(data)

                for(let i=0; i<6; i++){
                    let city = data.city.name
                    let weather = data.list[i].weather[0].description
                    let temp = Math.floor(data.list[i].temp.day)
                    let temp_max = Math.floor(data.list[i].temp.max)
                    let temp_min = Math.floor(data.list[i].temp.min)
                    let dt = data.list[i].dt
                    let time = moment(dt * 1000).format('HH:mm')
                    let day = moment(dt*1000).format('MM/DD')
                    let date = moment(dt*1000).format('ddd')
                    let icon2 = data.list[i].weather[0].icon

                    let date_te = (temp_max + '°' + '/' + temp_min + '°')

                    let rain2 = data.list[i].rain
                    if(rain2 == null){
                        rain2 = 0
                    }

                    let dom2 = $('<div class="date_one"></div>')
                    dom2.append('<p class="date_d">' + date + '</p>')
                    dom2.append('<p class="date_temmm">' + date_te + '</p>')
                    dom2.append('<img class="date_we" src="#" alt="#">')
                    dom2.append('<img class="hu" src="humidity_mid.png" alt="#">' + '<p class="date_rain">' + rain2 + '%</p>')

                    if ($('body').hasClass('is-night')) {
                        dom2.find('.hu').attr('src', 'humidity_mid_n.png');
                    } else {
                        dom2.find('.hu').attr('src', 'humidity_mid.png');
                    }

                    if(icon2 == '01d'){
                        dom2.find('.date_we').attr('src', 'sun.png')
                    } else if(icon2 == '02d' || icon2 == '03d' || icon2 == '04d' ){
                        dom2.find('.date_we').attr('src', 'cloud.png')
                    } else if(icon2 == '09d' || icon2 == '10d'){
                        dom2.find('.date_we').attr('src', 'rain.png')
                    } else if(icon2 == '11d'){
                        dom2.find('.date_we').attr('src', 'storm.png')
                    } else if(icon2 == '13d'){
                        dom2.find('.date_we').attr('src', 'snow.png')
                    } else if(icon2 == '50d'){
                        dom2.find('.date_we').attr('src', 'mist.png')
                    }

                    $('#date').append(dom2)
                    

                }

            })
        })
    </script>
</body>

</html>

